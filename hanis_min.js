function PEvs(R,Ud,Vd,eb,Wd,Xd,Yd){var fb,F,B,H,ka,J,T,Qa,dc,la,ra,Ea,Lb,K,$a,zb,Ab,Fa=0,L=0,sa,Mb,ca=0,n=!1,Y=function(k){Qa=k.target;for(la=dc=0;Qa;)dc+=Qa.offsetLeft-Qa.scrollLeft,la+=Qa.offsetTop-Qa.scrollTop,Qa=Qa.offsetParent;Fa=k.pageX-dc-document.body.scrollLeft;L=k.pageY-la-document.body.scrollTop};this.getX=function(){return Fa};this.getY=function(){return L};var ta=function(k){Y(k);sa=Fa;Mb=L;H=!0;null!=zb&&(ka=(new Date).getTime());null!=Lb&&Lb(k)},f=function(k){Y(k);H=!1;null!=Ea&&Ea(k);
null!=zb&&(J=(new Date).getTime(),T=J-ka,300>T&&zb(k))},x=function(k){Y(k);3>Math.abs(Fa-sa)&&3>Math.abs(L-Mb)||(Mb=sa=-9999,H?null!=K&&K(k):null!=$a&&$a(k),null!=Ab&&ha())};this.touchDown=function(k){B=!0;ca+=k.changedTouches.length;if(1<ca)return n=!0,k.returnValue=!0;fb=k.changedTouches;F=fb[0];ta(F)};this.touchUp=function(k){B=!0;ca-=k.changedTouches.length;0>ca&&(ca=0);ca||(n=!1);if(n)return k.returnValue=!0;k.preventDefault();k.stopImmediatePropagation?k.stopImmediatePropagation():k.stopPropagation();
fb=k.changedTouches;F=fb[0];f(F)};this.touchMove=function(k){B=!0;if(n)return k.returnValue=!0;k.preventDefault();k.stopImmediatePropagation?k.stopImmediatePropagation():k.stopPropagation();fb=k.changedTouches;F=fb[0];x(F)};this.mouseDown=function(k){B||(k.preventDefault(),k.stopImmediatePropagation?k.stopImmediatePropagation():k.stopPropagation(),ta(k))};this.clearDown=function(){H=!1};this.mouseUp=function(k){B||(k.preventDefault(),k.stopImmediatePropagation?k.stopImmediatePropagation():k.stopPropagation(),
f(k))};this.mouseClick=function(k){k.preventDefault();k.stopImmediatePropagation?k.stopImmediatePropagation():k.stopPropagation();H=!1};this.mouseMove=function(k){B||(k.preventDefault(),k.stopImmediatePropagation?k.stopImmediatePropagation():k.stopPropagation(),x(k))};this.mouseDragged=function(k){B||(k.preventDefault(),k.stopImmediatePropagation?k.stopImmediatePropagation():k.stopPropagation(),Y(k),null!=K&&K(k),null!=Ab&&ha())};var ha=function(){clearTimeout(ra);ra=setTimeout(function(){Ab()},600)};
Mb=sa=L=Fa=0;Lb=Ud;Ea=Vd;$a=eb;K=Wd;zb=Xd;Ab=Yd;H=B=!1;R.addEventListener("mousedown",this.mouseDown,!1);R.addEventListener("mouseup",this.mouseUp,!1);R.addEventListener("mousemove",this.mouseMove,!1);R.addEventListener("click",this.mouseClick,!1);R.addEventListener("touchstart",this.touchDown,!1);R.addEventListener("touchend",this.touchUp,!1);R.addEventListener("touchmove",this.touchMove,!1);R.addEventListener("pointerdown",this.mouseDown,!1);R.addEventListener("pointerup",this.mouseUp,!1);R.addEventListener("pointermove",
this.mouseMove,!1);R.addEventListener("contextmenu",function(k){k.preventDefault()},!1);R.addEventListener("touchleave",this.touchUp,!1);R.addEventListener("touchenter",this.touchDown,!1);R.addEventListener("touchcancel",this.touchUp,!1);R.addEventListener("mouseout",function(k){H||(L=Fa=-1,null!=$a&&$a(k));H=!1})};var HAniS=new function(){function R(a,b,d,e,c){this.color=a;this.Hoverzone$alpha=1;7<this.color.length&&(this.Hoverzone$alpha=parseInt(this.color.substring(7),16)/255,this.color=this.color.substring(0,7),.1>this.Hoverzone$alpha&&(this.Hoverzone$alpha=.1));this.action=b;this.value=d;this.tip=e;this.poly=c;a=c.split(",");this.xy=[];this.ymin=this.xmin=9999;for(b=this.ymax=this.xmax=0;b<a.length;b++)this.xy[b]=parseInt(a[b].trim(),10),b%2?(this.xy[b]<this.ymin&&(this.ymin=this.xy[b]),this.xy[b]>this.ymax&&
(this.ymax=this.xy[b])):(this.xy[b]<this.xmin&&(this.xmin=this.xy[b]),this.xy[b]>this.xmax&&(this.xmax=this.xy[b]));this.height=this.ymax-this.ymin+1;this.width=this.xmax-this.xmin+1;this.can=t("canvas");this.can.height=this.height;this.can.width=this.width;this.ctx=this.can.getContext("2d");this.ctx.imageSmoothingEnabled=!1;this.ctx.fillStyle=this.color;this.ctx.globalAlpha=this.Hoverzone$alpha;this.ctx.beginPath();this.ctx.moveTo(this.xy[0]-this.xmin,this.xy[1]-this.ymin);for(b=2;b<this.xy.length;b+=
2)this.ctx.lineTo(this.xy[b]-this.xmin,this.xy[b+1]-this.ymin);this.ctx.closePath();this.ctx.fill()}function Ud(a,b,d,e,c){this.overlay=a;this.color=b;this.action=d;this.value=e;this.tip=c}function Vd(a,b,d,e,c,h,k,g,f){this.x0=a;this.y0=b;this.icon=null;this.isIcon=!1;"icon"==d?(this.icon=new Image,this.icon.hotspot=this,Zd=!0,this.icon.onload=function(a){this.gotit=!0;this.hotspot.x1=this.hotspot.x0+this.width;this.hotspot.y1=this.hotspot.y0+this.height;this.hotspot.width=this.width;this.hotspot.height=
this.height;this.hotspot.w2=this.width/2;this.hotspot.h2=this.height/2;this.hotspot.isIcon=!0},this.y1=this.x1=-1,this.icon.gotit=!1,this.icon.src=e.trim()):(this.width=parseInt(d,10),this.height=parseInt(e,10),this.x1=this.width+a,this.y1=this.height+b,this.w2=this.width/2,this.h2=this.height/2);this.Hotspot$pan=c;this.isPan=!1;"pan"===this.Hotspot$pan&&(this.isPan=!0);this.action=h;this.value=k;this.overlay=g;this.tip=f}function eb(a,b,d,e,c,h,k){this.bg=a;null!=a&&0==this.bg.indexOf("0x")&&(this.bg=
"#"+this.bg.substring(2));this.fg=b;null!=b&&0==this.fg.indexOf("0x")&&(this.fg="#"+this.fg.substring(2));this.font=d;this.fontHeight=Math.round(1.1*parseInt(d,10));this.scolor=e;null!=e&&0==this.scolor.indexOf("0x")&&(this.scolor="#"+this.scolor.substring(2));this.sblur=c;this.sxoff=h;this.syoff=k}function Wd(){var a,b,d,e,c,h,k,g,f=Math.PI/180;this.MORhanCylEqualDist$init=function(d){for(var e=[],g=1;g<d.length;g++)e[g]=parseFloat(d[g]);b=e[1];a=e[4]/e[5];c=e[6];h=e[7];d=this.MORhanCylEqualDist$toXY(e[2],
e[3]);c=d[0];h=d[1]};this.MORhanCylEqualDist$toXY=function(g,k){d=a*Qc(k-b)*f-c;e=-a*g*f-h;return[d,e]};this.toLatLon=function(d,e){k=-(e+h)/a/f;g=Qc((d+c)/a/f+b);return[k,g]}}function Xd(){var a,b,d,e,c,h,k,g,f,sc,p,q,l,m,t,x,w,r,C,y,n,B,A,u,v,D,z,E,G,F,H,P=Math.PI/180;this.MORhanPolarStereoEllips$init=function(d){for(var e=[],c=1;c<d.length;c++)e[c]=parseFloat(d[c]);a=e[1];b=e[2];y=0==e[8]?!1:!0;n=e[6];B=n*n;A=B*B;u=A*B;v=A*A;k=e[5]/e[7];H=e[7];y?(g=Math.cos(P*a),f=Math.sin(P*a)):(g=Math.cos(-a*
P),f=Math.sin(-a*P));w=g/Math.sqrt(1-B*f*f);C=(1-n*f)/(1+n*f);x=y?Math.tan(Math.PI/4-a*P/2)/Math.pow(C,n/2):Math.tan(Math.PI/4- -a*P/2)/Math.pow(C,n/2);m=e[9];t=e[10];d=this.MORhanPolarStereoEllips$toXY(e[3],e[4]);m=d[0];t=d[1]};this.MORhanPolarStereoEllips$toXY=function(g,l){y?(c=P*g,h=P*(l-b)):(c=P*-g,h=P*(b-l));C=(1-n*Math.sin(c))/(1+n*Math.sin(c));r=Math.tan(Math.PI/4-c/2)/Math.pow(C,n/2);D=90!=a&&-90!=a?k*w*r/x:2*k*H*r/Math.sqrt(Math.pow(1+n,1+n)*Math.pow(1-n,1-n));d=D*Math.sin(h);e=D*Math.cos(h);
y||(d=-d,e=-e);sc=d-m;p=e-t;return[sc,p]};this.toLatLon=function(h,g){d=h+m;e=g+t;D=Math.sqrt(d*d+e*e);r=90==a||-90==a?D*Math.sqrt(Math.pow(1+n,1+n)*Math.pow(1-n,1-n))/(2*k*H):D*x/(k*w);z=Math.PI/2-2*Math.atan(r);E=Math.sin(2*z);G=Math.sin(4*z);F=Math.sin(6*z);c=z+E*B/2+5*E*A/24+E*u/12+13*E*v/360+7*G*A/48+29*G*u/240+811*G*v/11520+7*F*u/120+81*F*v/1120+4279*Math.sin(8*z)*v/161280;y?(q=c/P,l=Math.atan2(d,e)/P+b):(q=-c/P,l=-Math.atan2(-d,-e)/P+b);return[q,Qc(l)]}}function Yd(){var a,b,d,e,c,h,k,g,f,
m,p,q,l,n,t,x,r,w,y,C,B,A,D,v,z,u,E,G,F,H,I,P,J,K,M,L=Math.PI/180;this.MORhanLambConConEllips$init=function(e){for(var c=[],h=1;h<e.length;h++)c[h]=parseFloat(e[h]);a=c[1];b=c[2];d=c[3];v=c[7];z=v*v;u=z*z;E=u*z;G=u*u;g=c[6]/c[8];f=Math.cos(L*a);m=Math.cos(L*b);q=Math.sin(a*L);p=Math.sin(b*L);B=f/Math.sqrt(1-z*q*q);A=m/Math.sqrt(1-z*p*p);y=Math.sqrt((1-q)/(1+q)*Math.pow((1+v*q)/(1-v*q),v));C=Math.sqrt((1-p)/(1+p)*Math.pow((1+v*p)/(1-v*p),v));I=(Math.log(B)-Math.log(A))/(Math.log(y)-Math.log(C));P=
B/(I*Math.pow(y,I));K=g*P*Math.pow(y,I);r=c[9];w=c[10];e=this.MORhanLambConConEllips$toXY(c[4],c[5]);r=e[0];w=e[1]};this.MORhanLambConConEllips$toXY=function(a,b){h=L*a;k=L*Qc(b-d);M=Math.sin(h);D=Math.sqrt((1-M)/(1+M)*Math.pow((1+v*M)/(1-v*M),v));H=g*P*Math.pow(D,I);J=I*k;e=H*Math.sin(J);c=K+H*Math.cos(J);l=e-r;n=c-w;return[l,n]};this.toLatLon=function(a,b){e=a+r;c=b+w;H=Math.abs(I)/I*Math.sqrt(e*e+(K-c)*(K-c));D=Math.pow(H/(g*P),1/I);F=Math.PI/2-2*Math.atan(D);J=0>I?Math.atan(-e/(c-K)):Math.atan(e/
(K-c));k=J/I;h=F+(z/2+5/24*u+E/12+13/360*G)*Math.sin(2*F)+(7/48*u+29/240*E+811/11520*G)*Math.sin(6*F)+(7/120*E+81/1120*G)*Math.sin(6*F)+4279/161280*G*Math.sin(8*F);t=h/L;x=Qc(d-k/L);return[t,x]}}var fb,F,B,H,ka,J,T,Qa,dc,la,ra,Ea,Lb,K,$a,zb,Ab,Fa,L,sa,Mb,ca,n,Y,ta,f,x,ha,k,ma,gb,Nb,hb,Rc,I,$d,za,Q,C,Sc,tc,ab,ae,be,ce,ec,O,U,w,r,W,V,Aa,ia,z,A,bf,ib,jb,y,Ob,uc,vc,Tc,wd,c,Ga,kb,Pb,xd,de,cf,yd,ua,fc,Qb,Bb,va,lb,Rb,wc,zd,Uc,xc,gc,Vc,Wc,Cb,ee,fe,ge,he,ie,Sb,mb,Zd,Ad,je,Ra,na,u,Bd,wa,Xc,nb,Cd,Dd,yc,X,Ed,
Db,hc,Ha,ja,ob,Eb,pb,Fb,zc,Ia,Sa,ke,Yc,Zc,$c,le,Fd,ic,da,Ja,Ka,bb,qb,rb,ad,Ta,Ua,jc,bd,Gd,me,ba,df,ne,ef,ff,gf,Ba,Ca,xa,cb,Va,kc,oe,pe,qe,hf,Gb,Ac,cd,Bc,re,Cc,Hd,se,Id,lc,D,dd,sb,ed,te,Hb,Dc,Ec,mc,ue,ve,fd,Jd,gd,oa,we,Fc,E,G,Kd,hd,Ib,Gc,id,La,Wa,jd,Hc,Ld,Da,tb,kd,ld,xe,md,nd,jf,ye,Md,Ic,Jc,kf,ze,Tb,Ub,od,Ae,Be,ub,Vb,Nd,Ce,De,Ee,Xa,ya,lf,Kc,pd,Fe,Ge,pa,Wb,vb,S,Lc,Ya,He,Ie,Je,Mc,Xb,Od,Jb,Yb,Zb,wb,nc,qd,mf,Ke,Nc,Pd,Le,Me,oc,nf,of,Kb,Ne,Qd,Oe,Pe,xb,v,Qe,Ma,m,$b,Na,Oa,Pa,rd,Rd,Re,pf,Oc,Sd,ac,Td,Se,sd,
td,Za,bc,pc,Te,ud,Ue,Pc,db,yf="N NNE NE ENE E ESE SE SSE S SSW SW WSW W WNW NW NNW N".split(" "),zf=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||function(a){setTimeout(a,10)},t=function(a){return document.createElement(a)},Z=function(a,b){return 0==a.trim().toLowerCase().indexOf(b)};HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(a,b,d){d=window.atob(this.toDataURL(b,
d).split(",")[1]);for(var e=d.length,c=new Uint8Array(e),h=0;h<e;h++)c[h]=d.charCodeAt(h);a(new Blob([c],{type:b||"image/png"}))}});this.setup=function(a,b){void 0==b&&(b="MORdivcan");L=document.getElementById(b);Pc="center";L.align=Pc;sa=t("div");sa.setAttribute("style","position:relative;border:0px;margin:0px;padding:0px;-webkit-user-select:none; -moz-user-select:none; -ms-user-select:none; user-select:none; -webkit-tap-heightlight-color:transparent;");ca=t("canvas");ca.setAttribute("style","position:absolute;top:0;left:0;z-index:1;");
ta=t("canvas");ta.setAttribute("style","position:absolute;top:0;left:0;z-index:2;");f=ta.getContext("2d");f.imageSmoothingEnabled=!1;sa.appendChild(ca);sa.appendChild(ta);L.appendChild(sa);K=new PEvs(ta,HAniS.down,HAniS.up,HAniS.move,HAniS.drag,null,HAniS.canTip);L.setAttribute("tabindex",0);L.addEventListener("keydown",function(a){37==a.keyCode?(ea(!1),qc(-1),fa()):39==a.keyCode?(ea(!1),qc(1),fa()):82==a.keyCode&&a.altKey&&HAniS.resetZoom()},!0);y=0;uc=!1;Ob=1;jb=ib=!0;mb=k=x=0;Tc=!0;wd=!1;Nb=null;
vc=!0;Ga=500;kb=100;Pb=2E3;xd=30;de=0;Sd=6E4;ac=null;Oc=!1;$d=Rc=db=I=null;hd=Kd=G=E=1;id=!1;A=z=ia=Aa=V=W=r=w=U=O=0;Yc=Lb=!1;Ra=0;Zd=!1;Sa=null;td=sd=Za=bc=0;ab=Ad=Fd=!1;kd=ld=Ic=Jc=0;Vb=Tb=tb=!1;Xa=null;ya=[0,0];nb=Ld=md=!1;hc=!0;X=Db=null;Ua=Ed=!1;ba=[];Xb=Od=!1;Oe=[1,0,0];Pe=[2,2,1];xb=[];Mc=[];Qb=fc=Ca=!1;ed=dd=0;var d=t("canvas");d.height=1;d.width=1;Y=d.getContext("2d");Y.imageSmoothingEnabled=!1;Dd=t("canvas");$a=!1;"string"===typeof a?0>a.indexOf("\n")?Af(a):Ve(a.split("\n")):Ve(a)};var Ve=
function(a){var b,d,e,N;ic=!0;if(a instanceof Array)for(c={},b=0;b<a.length;b++)2>a[b].length||(d=a[b].trim(),0!=d.indexOf("#")&&(e=d.indexOf("="),1>e||(N=d.substr(0,e).trim().toLowerCase(),c[N]=d.substr(e+1).trim())));else c=a;$a=!1;null!=c.debug&&("true"==c.debug?(Ab=window.open("","HAniSDebugInfo","scrollbars=yes,width=400,height=200"),$a=!0,aa("HAniS Version 3.3")):$a=!1);aa("Is type of param an array = "+(a instanceof Array));null!=c.divalign&&(Pc=c.divalign.trim(),L.align=Pc);null!=c.initial_message&&
(a=c.initial_message_style,null==a&&(a="background-color:red;top:10px;left:10px;height:100px;width:200px"),a="z-index:99;position:absolute;"+a,Ea=t("div"),Ea.setAttribute("style",a),Ea.innerHTML=c.initial_message,Ea.addEventListener("click",function(){Ea.style.visibility="hidden"},!1),Ea.style.visibility="visible",sa.appendChild(Ea),a=c.initial_message_timeout,null!=a&&("auto"==a?Lb=!0:(Lb=!1,a=parseInt(c.initial_message_timeout,10),2>a&&(a=2),setTimeout(function(){Ea.style.visibility="hidden"},1E3*
a))));null!=c.coordinates&&qf(c.coordinates);b="green";d="white";e="12px Arial";N=null;var h=10,f=10,g=10;Nd=2;Ce="Lat = ";De=" Lon = ";null!=c.coordinates_display_style&&(a=c.coordinates_display_style.split(","),b=a[0].trim(),d=a[1].trim(),e=a[2].trim(),3<a.length&&(Ce=a[3],De=a[4],Nd=parseInt(a[5],10),6<a.length&&(N=a[6].trim(),h=parseInt(a[7],10),f=parseInt(a[8],10),g=parseInt(a[9],10))));Ee=new eb(b,d,e,N,h,f,g);od=Ub=null;null!=c.map_scale&&(md=tb=!0,a=c.map_scale.split(","),Ub=parseFloat(a[0]),
od=1<a.length?parseFloat(a[1]):Ub);Ae=" ";null!=c.distance_unit&&(Ae=c.distance_unit.trim());Mb=" ";null!=c.divcan_style&&(Mb=c.divcan_style.trim());null!=c.imagecan_style&&(a=c.imagecan_style.trim()+";position:absolute;top:0;left:0;",ca.setAttribute("style",a+"z-index:1;"),ta.setAttribute("style",a+"z-index:2;"));b="blue";d="white";e="12px Arial";N=null;g=f=h=10;xe=1;ze="white";null!=c.distance_display_style&&(a=c.distance_display_style.split(","),b=a[0].trim(),d=a[1].trim(),ze=5<=a.length?a[4].trim():
d,e=a[2].trim(),xe=parseInt(a[3],10),5<a.length&&(N=a[5].trim(),h=parseInt(a[6],10),f=parseInt(a[7],10),g=parseInt(a[8],10)));kf=new eb(b,d,e,N,h,f,g);b="black";d="white";e="12px Arial";N=null;g=f=h=10;null!=c.probe_display_style&&(a=c.probe_display_style.split(","),b=a[0].trim(),d=a[1].trim(),e=a[2].trim(),3<a.length&&(N=a[3].trim(),h=parseInt(a[4],10),f=parseInt(a[5],10),g=parseInt(a[6],10)));mf=new eb(b,d,e,N,h,f,g);null!=c.pause&&(de=parseInt(c.pause,10));null!=c.auto_refresh&&(Sd=6E4*parseInt(c.auto_refresh,
10),ac=setInterval("HAniS.reloadFOF();",Sd),Oc=!0);yd=!1;null!=c.enable_smoothing&&Z(c.enable_smoothing,"t")&&(yd=!0);wd=!0;null!=c.check_image_size&&Z(c.check_image_size,"f")&&(wd=!1);a=Object.keys(c);for(b=0;b<a.length;b++)Z(a[b],"hotspot")&&We("hotspot="+c[a[b]]);null!=c.overlay_labels&&(gb=c.overlay_labels.split(","));Qb=!1;Bb=-1;null!=c.overlay_enhance&&(Qb=!0,Bb=parseInt(c.overlay_enhance,10)-1);Db=null;hc=!0;if(null!=c.overlay_allow_hoverzones)for(a=c.overlay_allow_hoverzones.split(","),Db=
Array(a.length),b=0;b<a.length;b++)if(Db[b]=!0,Z(a[b],"n")||Z(a[b],"f"))Db[b]=!1;B=F=null;fb=!1;null!=c.window_size&&(a=c.window_size.split(","),B=parseInt(a[0],10),F=parseInt(a[1],10),fb=!0);ad=null;if(null!=c.overlay_spacer)for(a=c.overlay_spacer.split(","),ad=Array(a.length),b=0;b<a.length;b++)ad[b]=parseInt(a[b],10);if(null!=c.overlay_probe_table)for(a=c.overlay_probe_table.split(","),b=0;b<a.length;b++)Mc[b]=parseInt(a[b],10)-1;Nb=null;if(null!=c.overlay_order)for(a=c.overlay_order.split(","),
Nb=Array(a.length),b=0;b<a.length;b++)Nb[parseInt(a[b],10)-1]=b;hb=null;if(null!=c.overlay_links)for(a=c.overlay_links.split(","),hb=Array(a.length),b=0;b<a.length;b++)hb[b]=parseInt(a[b],10);ec=null;if(null!=c.overlay_clear)for(a=c.overlay_clear.split(","),ec=Array(a.length),b=0;b<a.length;b++)ec[b]=a[b].trim().toLowerCase();Sc=null;if(null!=c.overlay_transparent_amount)for(a=c.overlay_transparent_amount.split(","),Sc=Array(a.length),b=0;b<a.length;b++)Sc[b]=parseFloat(a[b])/100;Wb=null;if(null!=
gb&&null!=c.overlay_zoom)for(a=c.overlay_zoom.split(","),Wb=Array(a.length),b=0;b<a.length;b++)if(Wb[b]=1,Z(a[b],"n")||Z(a[b],"f"))Wb[b]=0;else if(Z(a[b],"d")||Z(a[b],"h"))Wb[b]=-1;vb=null;if(null!=gb&&null!=c.overlay_preserve_list)for(a=c.overlay_preserve_list.split(","),vb=Array(a.length),b=0;b<a.length;b++)if(vb[b]=!0,Z(a[b],"n")||Z(a[b],"f"))vb[b]=!1;ed=0;te=" ";Hb="white";Dc="transparent";Ec="14pt arial";ue=!1;null!=c.times_label_style&&(a=c.times_label_style.split(","),Hb=a[0].trim(),1<a.length&&
(ed=Math.floor(60*parseFloat(a[1]))),1<a.length&&(ed="?"==a[1].trim()||"auto"==a[1].trim().toLowerCase()?-Math.floor((new Date).getTimezoneOffset()):Math.floor(60*parseFloat(a[1]))),2<a.length&&(te=a[2].trim()),3<a.length&&(Dc=a[3].trim()),4<a.length&&(Ec=a[4].trim()),5<a.length&&-1!=a[5].trim().indexOf("t")&&(ue=!0));0==Hb.indexOf("0x")&&(Hb="#"+Hb.substring(2));0==Dc.indexOf("0x")&&(Dc="#"+Dc.substring(2));mc=parseInt(Ec,10);hf=new eb("black","white",Ec,"black",20,5,5);ve=!1;null!=c.to_from_lock&&
(ve=Z(c.to_from_lock,"t")?!0:!1);b="black";d="white";e="14px arial";N=null;g=f=h=10;Le=Me=" ";Pd=oc=null;null!=c.dirspd_display_style&&(a=c.dirspd_display_style.split(","),b=a[0].trim(),d=a[1].trim(),e=a[2].trim(),Le=a[3],Me=a[4],5<a.length&&(N=a[5].trim(),h=parseInt(a[6],10),f=parseInt(a[7],10),g=parseInt(a[8],10)),Pd=new eb(b,d,e,N,h,f,g));b="black";d="white";e="14px arial";N=null;g=f=h=10;null!=c.tipbox_display_style&&(a=c.tipbox_display_style.split(","),b=a[0].trim(),d=a[1].trim(),e=a[2].trim(),
3<a.length&&(N=a[3].trim(),h=parseInt(a[4],10),f=parseInt(a[5],10),g=parseInt(a[6],10)));Be=new eb(b,d,e,N,h,f,g);S=null;if(null!=gb&&vb)for(a=c.overlay_preserve.split(","),S=Array(vb.length),b=e=0;b<vb.length;b++)if(vb[b]){S[b]=Array(4);for(d=0;4>d;d++)S[b][d]=parseInt(a[e].trim(),10),e+=1;S[b][2]=S[b][2]-S[b][0]+1;S[b][3]=S[b][3]-S[b][1]+1}Rc=null;I=c.image_base;null!=I?Rc=I=I.trim():null!=c.image_only_base?I=c.image_only_base.trim():I=null;$d=I;db=c.overlay_base;null!=db&&(db=c.overlay_base.trim());
ic=!0;if(null!=c.filenames){a=c.filenames.split(",");x=a.length;ha=Array(x);for(b=0;b<x;b++)ha[b]=null!=I?I+a[b].trim():a[b].trim();ic=!1;k=0}if(null!=c.basename){a=c.basename;null!=I&&(a=I+c.basename);d=c.base_starting_number;null==d&&(d=0);x=c.num_frames;null==x&&(x=c.num_images);x=parseInt(x,10);ha=Array(x);for(b=0;b<x;b++){e=b+parseInt(d,10);if(0<=a.indexOf("*"))ha[b]=a.replace("*",e);else if(0<=a.indexOf("?")){for(N=a;0<=N.lastIndexOf("?");)h=N.lastIndexOf("?"),N=N.substring(0,h)+e%10+N.substring(h+
1),e=Math.floor(e/10);ha[b]=N}else ha[b]=a+b;aa("image filename = "+ha[b])}null!=c.reverse_order&&Z(c.reverse_order,"t")&&ha.reverse();ic=!1;k=0}Ad=!0;a=c.background_static;null!=a&&(Z(a,"f")||Z(a,"n"))&&(Ad=!1);if(null!=c.overlay_filenames){a=c.overlay_filenames.split(",");ma=Array(x);for(b=0;b<a.length;b++)for(e=a[b].split("&"),k=a.length,d=0;d<x;d++)b||(ma[d]=Array(k)),ma[d][b]=e[d].trim(),null!=db?ma[d][b]=(db+ma[d][b]).trim():null!=I&&(ma[d][b]=(I+ma[d][b]).trim());ic=!1}pa=null;if(null!=c.image_preserve)for(a=
c.image_preserve.split(","),pa=[],b=0;b<a.length;b++)pa[b]=parseInt(a[b].trim(),10),1<b%4&&(pa[b]=pa[b]-pa[b-2]+1);we=!0;null!=c.keep_zoom&&Z(c.keep_zoom,"f")&&(we=!1);pc=Te=0;null!=c.hide_bottom&&(Te=parseInt(c.hide_bottom.trim(),10));ud=Ue=0;null!=c.hide_top&&(Ue=parseInt(c.hide_top.trim(),10));He="<div>";Je=300;Ie=500;null!=c.popup_style&&(a=c.popup_style,He='<div style="'+c.popup_style+'">');null!=c.popup_window_size&&(a=c.popup_window_size.split(","),Ie=a[0],Je=a[1]);Ib=!1;null!=c.active_zoom&&
Z(c.active_zoom,"t")&&(Ib=!0);Fc=1;null!=c.zoom_scale&&(Fc=parseFloat(c.zoom_scale));Gc=9999999;null!=c.maximum_zoom&&(Gc=parseFloat(c.maximum_zoom));Td=!0;null!=c.use_progress_bar&&Z(c.use_progress_bar,"f")&&(Td=!1);null!=c.dwell?(a=c.dwell.split(","),Ga=parseInt(a[0].trim(),10),1<a.length&&(kb=parseInt(a[1].trim(),10),10>kb&&(kb=10),Pb=parseInt(a[2].trim(),10),xd=parseInt(a[3].trim(),10))):null!=c.rate&&(a=c.rate.split(","),Ga=Math.round(1E4/parseFloat(a[0].trim())),1<a.length&&(kb=Math.round(1E4/
parseFloat(a[2].trim())),10>kb&&(kb=10),Pb=Math.round(1E4/parseFloat(a[1].trim()))));Gb=null;if(null!=c.times){a=c.times.split(",");Gb=Array(a.length);for(b=0;b<a.length;b++)Gb[b]=parseInt(a[b].trim(),10);rf(Gb)}Cc=null;null!=c.extrap_times_template&&(Cc=RegExp(c.extrap_times_template));pe=["Click on target's initial position","Click on target's final position","Move pointer around or click here to select target"];null!=c.extrap_prompts&&(pe=c.extrap_prompts.split(","));bd=["Click on first point to mark",
"Save points","Remove last point"];null!=c.mark_prompts&&(bd=c.mark_prompts.split(","));Gd="12pt Arial";me="white";null!=c.mark_prompts_style&&(a=c.mark_prompts_style.split(","),Gd=a[0].trim(),1<a.length&&(me=a[1].trim()));if(null!=c.probe_table){a=new XMLHttpRequest;Ma=[];Re=[];Yb=[];var n=" ";Zb=[];var sc="Value=";wb=[];var p=1;$b=[];Rd=[];Na=[];Oa=[];Pa=[];var q,l=-1;m=-1;var r=0;a.onload=function(){for(var a=this.responseText.split("\n"),b=0;b<a.length;b++)if(!(2>a[b].length)){var d=a[b].replace(/\s+/g,
" ").trim().split(","),e=d[0].split(" ");if(0==e[0].indexOf("*"))m++,Ma[m]=[],Zb[m]=[],Yb[m]=[],wb[m]=[],Na[m]=[],Oa[m]=[],Pa[m]=[],Rd[m]=[],$b[m]=[],l=-1,Re[m]=1<d.length?d[1].trim():"None",r=1;else if(r){l++;var c=Array(3);Ma[m][l]=parseFloat(e[0]);Na[m][l]=parseInt(e[1].trim(),10);Oa[m][l]=parseInt(e[2].trim(),10);Pa[m][l]=parseInt(e[3].trim(),10);l&&(c[0]=Na[m][l]-Na[m][l-1],c[1]=Oa[m][l]-Oa[m][l-1],c[2]=Pa[m][l]-Pa[m][l-1],q=0,Math.abs(c[1])>Math.abs(c[q])&&(q=1),Math.abs(c[2])>Math.abs(c[q])&&
(q=2),Rd[m][l-1]=q,$b[m][l-1]=c,0==$b[m][l-1][q]&&($b[m][l-1][q]=1));1<d.length&&(0==d[1].trim().indexOf('"')?(p=-1,d=d[1].trim(),sc=d.substr(1,d.length-2),n=""):(p=parseInt(d[1],10),2<d.length&&(n=d[2].trim()),3<d.length&&(sc=d[3].trim())));Zb[m][l]=sc;wb[m][l]=p;Yb[m][l]=n}}};a.open("get",c.probe_table,!0);a.send()}Qa=c.controls;aa("controls = "+c.controls);aa("bottom_controls = "+c.bottom_controls);Ya=Lc=rb=qb=Ka=Ja=da=null;null!=Qa&&sf(Qa,!0);dc=c.bottom_controls;null!=dc&&sf(dc,!1);ic?HAniS.getFOF():
(vc=!0,Xe())},qf=function(a){a=a.split(",");"PS"===a[0]?(Xa=new Xd,Xa.MORhanPolarStereoEllips$init(a)):"CE"==a[0]?(Xa=new Wd,Xa.MORhanCylEqualDist$init(a)):"LCC"==a[0]?(Xa=new Yd,Xa.MORhanLambConConEllips$init(a)):(Xa=null,Kc=parseFloat(a[0]),pd=parseFloat(a[1]),Fe=parseFloat(a[2]),Ge=parseFloat(a[3]))},Af=function(a){var b=new XMLHttpRequest;b.onload=function(){Ve(this.responseText.split("\n"))};b.open("get",a+"?"+Math.round(1E5*Math.random()),!0);b.send()},tf=function(a){var b;if(ec){for(b=0;b<
ec.length;b++)-1!=ec[b].indexOf(a)&&(C[b].checked=!1);for(b=0;b<ec.length;b++)Ye(b)}},rf=function(a){var b;Hd=Array(a.length);for(var d=0;d<a.length;d++){var e=60*Math.floor(a[d]/100)+Math.floor(a[d])%100;d||(sb=e);b=e-sb;0>b&&(b=e+1440-sb);Hd[d]=b;aa("times s="+e+"  min="+Hd[d])}sb+=ed;1440<=sb&&(sb-=1440);0>sb&&(sb+=1440);aa("Starting minute = "+sb)},uf=function(a,b){if(0!=a)for(var d=0;d<a;d++)0==C[na[d].overlay].isGhost&&(C[na[d].overlay].parentNode.style.visibility=b)};this.reloadFOF=function(){aa("reload FoF = "+
ac);tf("r");ic?HAniS.newFOF(pf):(vc=!0,Xe())};this.getFOF=function(){var a=c.file_of_filenames.trim();HAniS.newFOF(null!=Rc?Rc+a:a)};this.newFOF=function(a){var b,d,e,c,h,f=new XMLHttpRequest,g,n,m,p,q,l;je=Ra;var t=null;Fd=!1;jb=ib;ea(!1);Ra=x=0;ha=[];Sb=null;mb=0;wa=null;Xc=0;nb=Cd=!1;Ha=null;zc=!1;ja=-1;Fb=pb=Eb=ob=null;ke=-1;ma=[];var r=!1;if(!Gb||Cc)Gb=[];aa("new FOF="+a);Ca&&(null!=Ba&&(Ba.innerHTML=Ba.label_on,L.style.cursor="default",ea(jb),xa=-1),Ca=!1,ga());Ua&&(null!=Ta&&(Ta.innerHTML=
Ta.label_on,L.style.cursor="default",ea(jb),jc=-1),Ua=!1,ga());f.onload=function(){var a=this.responseText.split("\n");for(b=0;b<a.length;b++)if(!(2>a[b].length)&&(g=a[b].trim(),aa("FOF: "+g),0!=g.indexOf("#")))if(0==g.indexOf("fof_extension"))q=g.split("="),t=q[1].trim();else if(0==g.indexOf("image_base"))q=g.split("="),I=q[1].trim();else if(0==g.indexOf("overlay_base"))q=g.split("="),db=q[1].trim();else if(0==g.indexOf("high_res_basemap")){q=g.split("=");l=q[1].split(",");Eb=[];for(d=0;d<l.length;d++)Eb[d]=
l[d].trim(),null!=I&&(Eb[d]=I+Eb[d]);zc=!0}else if(0==g.indexOf("high_res_overlay")){q=g.split("=");l=q[1].split(",");ke=parseInt(l[0].trim(),10)-1;Fb=[];for(d=1;d<l.length;d++)Fb[d-1]=l[d].trim(),null!=db?Fb[d-1]=db+Fb[d-1]:null!=I&&(Fb[d-1]=I+Fb[d-1]);zc=!0}else if(0==g.indexOf("high_res_zoom")){q=g.split("=");l=q[1].split(",");Ha=[];for(d=0;d<l.length;d++)Ha[d]=parseFloat(l[d].trim());Ze()}else if(0==g.indexOf("hoverzone"))Bf(g);else if(0==g.indexOf("hotzone"))vf(g);else if(0==g.indexOf("hotspot"))We(g);
else if(0==g.indexOf("toggle_onoff"))q=g.split("="),Zc=q[1].split(",");else if(0==g.indexOf("coordinates"))q=g.split("="),qf(q[1]);else if(0==g.indexOf("map_scale"))q=g.split("="),l=q[1].split(","),Ub=parseFloat(l[0]),od=1<l.length?parseFloat(l[1]):Ub;else if(0==g.indexOf("times")){q=g.split("=");l=q[1].split(",");for(b=0;b<l.length;b++)Gb[b]=parseInt(l[b].trim(),10);r=!0}else{if(Cc){var f=g.match(Cc);null!=f&&2==f.length?(Gb.push(parseInt(f[1],10)),aa("+ + + Extrap time = "+f[1]),r=!0):aa("+ + + Cannot parse times using "+
Cc+" from line: "+g)}e=g.indexOf(" ");0>e&&(e=g.length);ha[x]=g.substring(0,e).trim();null!=I&&(ha[x]=I+ha[x]);g=g.substring(e+1);c=g.indexOf('"');0<=c&&(Ia||(Ia=[]),e=g.substring(c+1),c=e.indexOf('"'),0<=c&&(Ia[x]=e.substring(0,c),0==x&&(Sa.innerHTML=Ia[0])));ma[x]=[];c=g.indexOf("overlay");if(0<=c)for(n=g.substring(c),c=n.indexOf("="),0>c&&aa("Cannot find a = sign in "+n),m=n.substring(c+1),n=m.trim(),m=n.split(","),k=m.length,aa("numOverlays set to "+k),h=0;h<m.length;h++)ma[x][h]=m[h].trim(),
null!=db?ma[x][h]=(db+ma[x][h]).trim():null!=I&&(ma[x][h]=(I+ma[x][h]).trim());x+=1}r&&rf(Gb);null!=t?(a=new XMLHttpRequest,a.onload=function(){var a=this.responseText.split("\n");for(b=0;b<a.length;b++)2>a[b].length||(p=a[b].trim(),aa("ext_FOF: "+p),0!=p.indexOf("#")&&(0==p.indexOf("hotzone")?vf(p):0==p.indexOf("hotspot")&&We(p)));$e()},a.onerror=function(){$e()},a.open("get",t+"?"+Math.round(1E5*Math.random()),!0),a.send()):$e()};pf=a;f.open("get",a+"?"+Math.round(1E5*Math.random()),!0);f.send()};
var $e=function(){0!=Ra?uf(Ra,"visible"):0!=je&&uf(je,"hidden");vc=!0;Xe()},Xe=function(){var a,b,d,c="?"+Math.round(1E4*Math.random());za=Array(x);bc=Za=0;Se=Td;Ld&&(Wa.max=x);Tc&&(fc||Qb)&&(lb=[],va=[],Rb=[],zd=[],Uc=[]);null!=ua&&(ua.selectedIndex=0);for(a=0;a<x;a++){Tc&&(fc||Qb)&&(lb[a]=t("canvas"),va[a]=t("canvas"));za[a]=new Image;za[a].gotit=!1;za[a].frameNum=a;za[a].onerror=function(){Za++};za[a].onload=function(){Tc&&(Tc=!1,H=this.height,ka=this.width,ia=H,Aa=ka,fb?(ca.height=F,ca.width=
B,ta.height=F,ta.width=B):(ca.height=ia,ca.width=Aa,ta.height=ia,B=ta.width=Aa,F=ia),sd=B/2-100,td=F/2-10,J=1*Aa/B,T=1*ia/F,sa.setAttribute("style","position:relative;border:0px;margin:0px;padding:0px;-webkit-user-select:none; -moz-user-select:none; -ms-user-select:none; user-select:none; -webkit-tap-heightlight-color:transparent;"+Mb+"height:"+F+"px;width:"+B+"px;"));if(0<Xc&&!Cd){Dd.height=H;Dd.width=ka;yc=Dd.getContext("2d");yc.clearRect(0,0,B,F);for(var a=0;a<wa.length;a++){for(var N=wa[a].ctx.getImageData(0,
0,wa[a].width,wa[a].height).data,g=yc.getImageData(wa[a].xmin,wa[a].ymin,wa[a].width,wa[a].height),m=3;m<N.length;m+=4)0!=N[m]&&(g.data[m]=a+1);yc.putImageData(g,wa[a].xmin,wa[a].ymin)}Ib||(nb=!0);Cd=!0}if(vc){vc=!1;n=ca.getContext("2d");n.imageSmoothingEnabled=yd;n.fillStyle="blue";n.font="bold 20px Arial";f=ta.getContext("2d");f.imageSmoothingEnabled=yd;xc=Array(x);Yc&&Cf(x);if(0<k)for(Q=Array(x),d=0;d<x;d++)for(Q[d]=Array(k),b=0;b<k;b++)Q[d][b]=new Image,Q[d][b].gotit=!1,Q[d][b].frameNum=d,Q[d][b].overlayNum=
b,Q[d][b].onerror=function(){Za++},Q[d][b].onload=function(){this.gotit=!0;Za++;vd();if(this.height!=H||this.width!=ka)this.gotit=!1,aa("Bad image size:"+this.src);if(Qb&&this.gotit&&this.overlayNum==Bb){var a=this.frameNum;lb[a].height=this.height;lb[a].width=this.width;wc=lb[a].getContext("2d");wc.drawImage(this,0,0);zd[a]=wc.getImageData(0,0,this.width,this.height).data;va[a].height=this.height;va[a].width=this.width;Rb[a]=va[a].getContext("2d");Rb[a].drawImage(this,0,0);Uc[a]=Rb[a].getImageData(0,
0,this.width,this.height);Q[a][this.overlayNum]=null;Q[a][this.overlayNum]=va[a];Q[a][this.overlayNum].gotit=!0}},a=ma[d][b],tc&&!tc[b]&&(a=ma[d][b]+c),Q[d][b].src=a,bc++;if(Eb)for(ob=[],b=0;b<Eb.length;b++)ob[b]=new Image,ob[b].gotit=!1,ob[b].onerror=function(a){Za++},ob[b].onload=function(a){a.currentTarget.gotit=!0;Za++;vd()},ob[b].src=Eb[b],bc++;if(Fb)for(pb=[],b=0;b<Eb.length;b++)pb[b]=new Image,pb[b].gotit=!1,pb[b].onerror=function(a){Za++},pb[b].onload=function(a){a.currentTarget.gotit=!0;
Za++;vd()},pb[b].src=Fb[b],bc++}!wd&&0!=this.height&&0!=this.width||this.height==H&&this.width==ka?this.gotit=!0:(this.gotit=!1,aa("Image has invalid size:"+this.src));fc&&this.gotit&&(a=this.frameNum,lb[a].height=this.height,lb[a].width=this.width,wc=lb[a].getContext("2d"),wc.drawImage(this,0,0),zd[a]=wc.getImageData(0,0,this.width,this.height).data,va[a].height=this.height,va[a].width=this.width,Rb[a]=va[a].getContext("2d"),Rb[a].drawImage(this,0,0),Uc[a]=Rb[a].getImageData(0,0,this.width,this.height),
za[a]=null,za[a]=va[a],za[a].gotit=!0);Za++;vd();we||HAniS.resetZoom();Fd=!0;bf||(bf=!0,ib=!1,wf());ea(jb)};var N=ha[a];Ad||(N=ha[a]+c);za[a].src=N;bc++}Tb=ab=!1;ga()},qa=function(a,b,d,e,f){a.label_on=d;a.label_off=e;d=null;e=c[b+"_labels"];null==e&&(e=c[b+"_label"]);null!=e&&(e=e.split(","),a.label_on=e[0].trim(),1<e.length&&(a.label_off=e[1].trim()),2<e.length&&(d="width:"+e[2].trim()+"px;"));null!=f&&(a.title=f);a.innerHTML=a.label_on;b=(null!=d?d:"")+Fa+c[b+"_style"];null!=b&&a.setAttribute("style",
b)},sf=function(a,b){var d,e,f,h;Fa=c.buttons_style;var k=null,g=null,k=b?c.controls_tooltip:c.bottom_controls_tooltip,n=a.split(",");null!=k&&(f=k.split(","),f.length!=n.length&&(aa("!!! Number of tooltips must equal number of controls!"),f=k=null));var r=null,p;for(d=0;d<n.length;d++){null!=k?p=f[d]:p=null;var q=n[d].trim(),l=q.indexOf("/");0!==l&&d||(0===l&&(q=q.substring(1)),h=t("div"),h.align=Pc,null!=c.controls_style?h.setAttribute("style",c.controls_style):h.setAttribute("style","position:relative;padding:2px;width:100%;"),
b?L.insertBefore(h,sa):(null!=c.bottom_controls_style&&h.setAttribute("style",c.bottom_controls_style),L.appendChild(h)));l=c.enhance_filename;null==l&&(l=c.enhance_table);if("enhance"==q.trim()&&null!=l){ua=t("select");g=c.enhance_style;null!=g&&ua.setAttribute("style",g);null!=p&&(ua.title=p);g=t("option");g.innerHTML="Pick Enhancement";g.value=-1;ua.add(g);ua.addEventListener("change",HAniS.doEnhance,!1);fc=!Qb;ua.disabled=fc?!1:!0;h.appendChild(ua);g=new XMLHttpRequest;Ma=[];Yb=[];Zb=[];wb=[];
var w,v,z;Na=[];Oa=[];Pa=[];rd=[];m=-1;var B=!1,u,D,A,E,G,F,I,H,K,J,T,Q,U;g.onload=function(){for(var a=this.responseText.split("\n"),b=0;b<a.length;b++)if(!(2>a[b].length)){var d=a[b].replace(/\s+/g," ").trim(),c=d.indexOf("#");if(0!=c)if(0<c&&(d=d.substring(0,c)),0==d.indexOf("*"))m++,Ma[m]=Array(256),Zb[m]=Array(256),Yb[m]=Array(256),wb[m]=Array(256),Na[m]=Array(256),Oa[m]=Array(256),Pa[m]=Array(256),rd[m]=Array(256),Ma[m]=Array(256),w=" ",v="Value =",z=1,c=t("option"),c.innerHTML=d.substring(1),
c.value=m,ua.add(c);else{var e=d.indexOf("value");0>e&&(e=d.indexOf("probe"));B=!1;J=T=0;0<e&&(c=d.substring(e+1),d=d.substring(0,e),e=c.indexOf("="),c=c.substring(e+1),c=c.split(","),1==c.length?(v=c[0].trim(),z=-1,B=!1):(J=parseFloat(c[0].trim()),T=parseFloat(c[1].trim()),2<c.length&&(z=parseInt(c[2],10)),3<c.length&&(w=c[3].trim()),4<c.length&&(v=c[4].trim()),B=!0));d=d.split(" ");u=parseInt(d[0].trim(),10);D=parseInt(d[1].trim(),10);A=D-u;E=parseFloat(d[2].trim());G=parseFloat(d[3].trim());F=
parseFloat(d[4].trim());I=parseFloat(d[5].trim());H=parseFloat(d[6].trim());K=parseFloat(d[7].trim());Q=U=255;9<d.length&&(Q=parseFloat(d[8].trim()),U=parseFloat(d[9].trim()));for(d=u;d<=D;d++)A?(Na[m][d]=Math.round(E+(G-E)*(d-u)/A),Oa[m][d]=Math.round(F+(I-F)*(d-u)/A),Pa[m][d]=Math.round(H+(K-H)*(d-u)/A),rd[m][d]=Math.round(Q+(U-Q)*(d-u)/A)):(Na[m][u]=E,Oa[m][u]=F,Pa[m][u]=H,rd[m][u]=Q),Zb[m][d]=v,Yb[m][d]=w,wb[m][d]=z,B&&(Ma[m][d]=J+(T-J)*(d-u)/A)}}};g.open("get",l,!0);g.send()}"startstop"==q&&
(da=t("button"),da.className="startstop start",qa(da,"startstop","Start","Stop",p),da.addEventListener("click",HAniS.toggleIsLooping,!1),h.appendChild(da));"looprock"==q&&(La=t("button"),La.className="looprock rock",qa(La,"looprock","Rock","Loop",p),Ob=1,La.addEventListener("click",HAniS.toggleLoopRock,!1),h.appendChild(La));"extrap"==q&&(Ba=t("button"),Ba.className="extrap",qa(Ba,"extrap","Enable Extrap","Disable Extrap",p),Ba.addEventListener("click",HAniS.toggleExtrap,!1),h.appendChild(Ba));Z(q,
"location")&&(ub=t("button"),ub.className="location",qa(ub,"location","Show Loc","Hide Loc",p),0<q.indexOf("/on")?(ub.innerHTML=ub.label_off,Vb=!0):Vb=!1,ub.addEventListener("click",function(){Vb=!Vb;ub.innerHTML=Vb?ub.label_off:ub.label_on},!1),h.appendChild(ub));"distance"==q&&(Da=t("button"),Da.className="distance",qa(Da,"distance","Show dist","Hide dist",p),tb=md=!1,Da.addEventListener("click",function(){tb=!tb;Da.innerHTML=tb?Da.label_off:Da.label_on},!1),h.appendChild(Da));"probe"==q&&(Jb=t("button"),
Jb.className="probe",qa(Jb,"probe","Show probe","Hide probe",p),Xb=Od=!1,Ke="Undefined",Nc=0,null!=c.probe_undefined&&(l=c.probe_undefined.split(","),Ke=l[0].trim(),1<l.length&&(Nc=parseInt(l[1],10)+1)),Jb.addEventListener("click",function(){(Od=!Od)?(Jb.innerHTML=Jb.label_off,Xb=!0):(Jb.innerHTML=Jb.label_on,Xb=!1)},!1),h.appendChild(Jb));"mark"==q&&(Ta=t("button"),Ta.className="mark",qa(Ta,"mark","Mark","Stop Mark",p),Ta.addEventListener("click",function(){Ua=!Ua;ba=[];Ua?(jc=0,Ta.innerHTML=Ta.label_off,
null!=oa&&(oa.disabled=!0)):(Ta.innerHTML=Ta.label_on,null!=oa&&(oa.disabled=!1),jc=-1);ga()},!1),df=new eb("black","white",Gd,"black",20,5,5),ne=new eb("black","white",Gd,"black",20,5,5),h.appendChild(Ta));"refresh"==q&&(Lc=t("button"),Lc.className="refresh",qa(Lc,"refresh","Refresh",null,p),Lc.addEventListener("click",HAniS.reloadFOF,!1),h.appendChild(Lc));"setframe"==q&&(Wa=t("input"),Wa.className="setframe",Wa.type="range",Wa.min=1,Wa.max=100,Wa.value=1,jd="Frame #*",null!=c.setframe_label&&(jd=
c.setframe_label),Hc=t("span"),Hc.innerHTML=jd.replace("*",1),g="display:block;vertical-align:middle;"+c.setframe_style,Wa.setAttribute("style",g),l=t("span"),l.setAttribute("style","display:inline-block;vertical-align:top;"),Hc.setAttribute("style","display:block;vertical-align:middle;"+c.setframe_label_style),l.appendChild(Hc),l.appendChild(Wa),h.appendChild(l),Wa.addEventListener("input",function(a){ea(!1);cc(parseInt(Wa.value,10)-1);Hc.innerHTML=jd.replace("*",y+1);fa()},!1),Ld=!0);"framelabel"==
q&&(Sa=t("button"),Sa.className="framelabel",Sa.innerHTML="",Ia=null,null!=c.frame_labels&&(Ia=c.frame_labels.split(","),Sa.innerHTML=Ia[0]),g=Fa+c.framelabel_style,null!=g&&Sa.setAttribute("style",g),h.appendChild(Sa));if("autorefresh"==q||"autorefresh/off"==q)null!=ac&&clearInterval(ac),Ya=t("button"),Ya.className="autorefresh",qa(Ya,"autorefresh","Disable Auto Refresh","Enable Auto Refresh",p),Ya.addEventListener("click",HAniS.toggleAutoRefresh,!1),Oc=!1,h.appendChild(Ya),"autorefresh"==q?HAniS.toggleAutoRefresh():
Ya.innerHTML=Ya.label_off;"backward"==q&&(Ka=t("button"),Ka.className="step back",qa(Ka,"backward","<","<",p),Ka.addEventListener("click",function(){ea(!1);qc(-1);fa()},!1),h.appendChild(Ka));"forward"==q&&(Ja=t("button"),Ja.className="step forward",qa(Ja,"forward",">",">",p),Ja.addEventListener("click",function(){ea(!1);qc(1);fa()},!1),h.appendChild(Ja));"step"==q&&(l=c.step_labels,l=null!=l?l.split(","):["<",">"],Ka=t("button"),Ka.className="step back",Ka.innerHTML=l[0],Ka.addEventListener("click",
function(){ea(!1);qc(-1);fa()},!1),g=Fa+c.step_style,null!=g&&Ka.setAttribute("style",g),null!=p&&(Ka.title=p),h.appendChild(Ka),Ja=t("button"),Ja.className="step forward",Ja.innerHTML=l[1],Ja.addEventListener("click",function(){ea(!1);qc(1);fa()},!1),null!=g&&Ja.setAttribute("style",g),null!=p&&(Ja.title=p),h.appendChild(Ja));"first"==q&&(la=t("button"),la.className="firstlast first",qa(la,"first","|<","|<",p),la.addEventListener("click",function(){ea(!1);cc(0);fa()},!1),h.appendChild(la));"last"==
q&&(ra=t("button"),ra.className="firstlast last",qa(ra,"last",">|",">|",p),ra.addEventListener("click",function(){ea(!1);cc(x-1);fa()},!1),h.appendChild(ra));"firstlast"==q&&(l=c.firstlast_labels,l=null!=l?l.split(","):["<<",">>"],la=t("button"),la.className="firstlast",la.innerHTML=l[0],la.addEventListener("click",function(){ea(!1);cc(0);fa()},!1),g=Fa+c.firstlast_style,null!=g&&la.setAttribute("style",g),null!=p&&(la.title=p),h.appendChild(la),ra=t("button"),ra.className="firstlast",ra.innerHTML=
l[1],ra.addEventListener("click",function(){ea(!1);cc(x-1);fa()},!1),null!=g&&ra.setAttribute("style",g),null!=p&&(ra.title=p),h.appendChild(ra));"setspeed"==q?(bb=t("input"),bb.className="setspeed",bb.type="range",bb.min=kb,bb.max=Pb,bb.value=Pb-Ga,null!=p&&(bb.title=p),g="vertical-align:middle;"+c.setspeed_style,bb.setAttribute("style",g),bb.addEventListener("input",function(a){Ga=Pb-parseInt(bb.value,10)+30;ea(!0);fa()},!1),h.appendChild(bb)):"speed"==q&&(l=c.speed_labels,l=null!=l?l.split(","):
["-","+"],rb=t("button"),rb.className="speed slower",rb.innerHTML=l[0],rb.addEventListener("click",function(){Ga+=xd;qb.disabled=!1;Ga>Pb&&(Ga=Pb,rb.disabled=!0)},!1),g=Fa+c.speed_style,null!=g&&rb.setAttribute("style",g),null!=p&&(rb.title=p),h.appendChild(rb),qb=t("button"),qb.className="speed faster",qb.innerHTML=l[1],qb.addEventListener("click",function(){Ga-=xd;rb.disabled=!1;Ga<kb&&(Ga=kb,qb.disabled=!0)},!1),null!=g&&qb.setAttribute("style",g),null!=p&&(qb.title=p),h.appendChild(qb));"zoom"==
q&&(oa=t("button"),oa.className="zoom off",qa(oa,"zoom","Zoom","Un-zoom",p),oa.addEventListener("click",HAniS.toggleZooming,!1),h.appendChild(oa));if("capture"==q){gd=t("button");gd.className="capture";qa(gd,"capture","Capture","Capture",p);var W=c.capture_prompt;gd.addEventListener("click",function(){var a="haimage.png";if(null!=W&&(a=window.prompt(W,a),null==a))return;var b=t("canvas");b.height=ca.height;b.width=ca.width;var d=b.getContext("2d");d.drawImage(ca,0,0);d.drawImage(ta,0,0);b.toBlob(function(b){var d=
URL.createObjectURL(b),c=document.createElement("a");c.href=d;c.download=a;d=new MouseEvent("click");c.dispatchEvent(d);setTimeout(function(){URL.revokeObjectURL(b)},3E4)})},!1);h.appendChild(gd)}"show"==q&&(fd=t("button"),fd.className="show",qa(fd,"show","Show","Show",p),Jd=c.show_prompt,null==Jd&&(Jd="Right-click to save or copy the image<br> <font size='-1'>(to save in some browsers, you may need to first 'Open in New Tab')</font> <p>"),fd.addEventListener("click",function(){var a=ca.toDataURL("image/png;base64;");
window.open().document.write(Jd+"<img src="+a+"></img>")},!1),h.appendChild(fd));"toggle"==q&&(xc=[],l=c.toggle_size,null!=l?(l=l.split(","),gc=parseInt(l[0],10),Vc=parseInt(l[1],10),Wc=parseInt(l[2],10)):(Vc=gc=10,Wc=3),ge="red",he="blue",ie="orange",l=c.toggle_colors,null!=l&&(l=l.split(","),he=l[0].trim(),ge=l[1].trim(),ie=l[2].trim()),Cb=t("div"),Cb.setAttribute("style","position:relative;border:0px;margin:0px;padding:0px;-webkit-user-select:none; -moz-user-select:none; -ms-user-select:none; user-select:none; -webkit-tap-heightlight-color:transparent;"),
Cb.style.backgroundColor=h.style.backgroundColor,Cb.align=Pc,fe=new PEvs(Cb,null,null,null,null,HAniS.togclick,null),$c=t("canvas"),$c.height=2*Vc,le=$c.getContext("2d"),Cb.appendChild($c),b?L.insertBefore(Cb,sa):L.appendChild(Cb),l=c.toggle_onoff,Zc=null,null!=l&&(Zc=l.split(",")),Yc=!0,null!=p&&(Cb.title=p));if("overlay"==q){C=[];l=c.overlay_tooltip;q=null;null!=l&&(q=l.split(","));l=c.overlay_radio;g=null;null!=l&&(g=l.split(","));var P=c.overlay_labels_color,V=null;null!=P&&(V=P.split(","));tc=
[];e=c.overlay_caching;P=null;null==e&&(e=c.overlay_static);null!=e&&(P=e.split(","));var X=!0;null!=c.overlay_nonewdiv&&(X=!1);for(e=0;e<gb.length;e++){var M=gb[e].trim();e&&0!=M.indexOf("/")||(0==M.indexOf("/")&&(M=M.substr(1)),X?(r=t("div"),r.align="center",b?L.insertBefore(r,sa):L.appendChild(r)):(r=t("span"),h.appendChild(r)),null!=c.overlay_labels_style&&r.setAttribute("style",c.overlay_labels_style));var O=!1,S=M.length;0<M.indexOf("/on")&&M.indexOf("/on")==S-3&&(O=!0,M=M.substr(0,S-3));var R=
!1;0<M.indexOf("/always")&&M.indexOf("/always")==S-7&&(R=O=!0);var Y=!1;0<M.indexOf("/hidden")&&M.indexOf("/hidden")==S-7&&(Y=!0);null!=P?Z(P[e],"y")||Z(P[e],"t")?tc[e]=!0:tc[e]=!1:tc[e]=!0;C[e]=t("input");C[e].type="checkbox";C[e].value=M;S="vertical-align:middle;";null!=c.checkbox_style&&(S+=c.checkbox_style);C[e].setAttribute("style",S);C[e].checked=O;C[e].name=0;null!=ua&&e==Bb&&C[e].checked&&(ua.disabled=!1);Db&&!Db[e]&&O&&(hc=!1);C[e].addEventListener("click",HAniS.overClick,!1);null!=l&&(O=
g[e].indexOf("/"),-1!=O&&(C[e].name=g[e].substr(O+1).trim()),-1!=g[e].indexOf("true")&&(C[e].type="radio",-1==O&&(C[e].name="all")));C[e].isGhost=!0;R||Y||(null!=q&&(C[e].title=q[e]),R=t("label"),R.htmlFor=M,null!=q&&(R.title=q[e]),R.appendChild(document.createTextNode(M)),M="vertical-align:middle;",null!=V&&(M=M+"color:"+V[e]+";"),R.setAttribute("style",M),M=t("span"),Y="10",ad&&(Y=10+ad[e]),M.setAttribute("style","margin-left:"+Y+"px;"),M.appendChild(C[e]),M.appendChild(R),r.appendChild(M),C[e].isGhost=
!1)}if(hb)for(e=0;e<gb.length;e++)Ye(e);else for(hb=Array(gb.length),e=0;e<gb.length;e++)hb[e]=0}}jb=!0;null!=c.start_looping&&Z(c.start_looping,"f")&&(jb=!1);ea(jb)},Ye=function(a){var b,d;if(0>hb[a]){d=!1;for(b=0;b<gb.length;b++)hb[b]!=-hb[a]||d||(d=C[b].checked);C[a].checked=d}},We=function(a){0==mb&&(Sb=[]);a=a.split("=")[1].split(",");var b=a[4].trim(),d=a[4].indexOf("/"),c=-1;-1!=d&&(c=parseInt(a[4].substring(d+1),10)-1,b=b.substring(0,d));Sb[mb]=new Vd(parseInt(a[0].trim(),10),parseInt(a[1].trim(),
10),a[2].trim(),a[3].trim(),b.toLowerCase(),a[5].trim().toLowerCase(),a[6].trim(),c,8==a.length?a[7].trim():null);mb+=1},Bf=function(a){0==Xc&&(wa=[],X=null);var b=a.split("=")[1].split("(");a=b[0].split(",");var d=a[0].trim();0==d.indexOf("0x")&&(d="#"+d.substring(2));wa[Xc]=new R(d,a[1].trim(),a[2].trim(),a[3].trim(),b[1].trim());Xc+=1},vf=function(a){0==Ra&&(na=[]);a=a.split("=")[1].split(",");na[Ra]=new Ud(parseInt(a[0],10)-1,parseInt(a[1],16),a[2].trim(),a[3].trim(),5==a.length?a[4].trim():"Click for details");
Ra+=1};this.drag=function(a){Ua||(O=K.getX(),U=K.getY(),w=O*J,r=U*T,Tb=ab=!1,tb&&(!md||md&&a.shiftKey)?(Ic=w,Jc=r,Tb=!0):(Ib&&G!=hd?(z=(W*E-w)/E,A=(V*G-r)/G,0>z&&(z=0),A<ud&&(A=ud),z+Aa>ka&&(z=ka-Aa),A+ia>H-pc&&(A=H-pc-ia),z=Math.round(z),A=Math.round(A),W=Math.round(z+w/E),V=Math.round(A+r/G)):Ua||Ca||!nb||(X=null,hc&&0<=w&&0<=r&&(u=yc.getImageData(w,r,1,1).data,0!=u[3]&&(X=wa[u[3]-1]))),id=!0,fa()),ga())};var Ze=function(){if(zc){ja=-1;for(var a=0;a<Ha.length;a++)E>=Ha[a]&&(ja=a)}},af=function(a,
b){"popup"==a.action?(zb&&zb.close(),zb=window.open("","HAniSPopup","scrollbars=yes,width="+Ie+",height="+Je),zb.document.write(He+a.value+"</div>")):"link"==a.action?window.open(a.value,"_blank",""):"fof"==a.action&&(I=$d,HAniS.resetZoom(),HAniS.newFOF(a.value),tf(b))};this.resetZoom=function(){E=Kd;G=hd;null!=oa&&(oa.innerHTML=oa.label_on,Ib=!1);W=w;V=r;A=z=0;ia=H;Aa=ka;Ze();fa();Cd&&(nb=!0)};this.canTip=function(){var a;ab=!1;O=K.getX();w=O*J;U=K.getY();r=U*T;if(!((Ua||Ca)&&r<qe&&w>oe)){W=Math.round(z+
w/E);V=Math.round(A+r/G);if(0!=Ra)for(a=0;a<Ra;a++)if(na[a].overlay>=k)aa(" Error...hotzone overlay # "+na[a].overlay+" > number of overlays = "+k);else if(C[na[a].overlay].checked&&(Y.clearRect(0,0,1,1),Y.drawImage(Q[y][na[a].overlay],W,V,1,1,0,0,1,1),u=Y.getImageData(0,0,1,1).data,Bd=(u[0]<<16)+(u[1]<<8)+u[2],Bd==na[a].color)){ab=!0;be=O;ce=U;ae=na[a].tip;break}if(0!=mb){var b,d,c,f;for(a=0;a<mb;a++)if(f=Sb[a],-1==f.overlay||C[f.overlay].checked)if(c=!1,f.isPan?f.isIcon?(b=(f.x0-z)*E-f.w2,d=(f.y0-
A)*G-f.h2,w>b&&w<b+f.width&&r>d&&r<d+f.height&&(c=!0)):(b=(f.x0-z)*E,d=(f.y0-A)*G,w>b&&w<b+f.width*E&&r>d&&r<d+f.height*G&&(c=!0)):w>f.x0&&w<f.x1&&r>f.y0&&r<f.y1&&(c=!0),c&&null!=f.tip){ab=!0;be=O;ce=U;ae=Sb[a].tip;break}}ga()}};this.move=function(){if(!Ca&&nb&&(X=null,hc)){var a=K.getX()*J,b=K.getY()*T;0<=a&&0<=b&&(u=yc.getImageData(a,b,1,1).data,0!=u[3]&&(X=wa[u[3]-1]))}Ca&&2<=xa&&(O=K.getX(),w=O*J,U=K.getY(),r=U*T);ga()};this.down=function(){ab&&(ab=!1,ga());O=K.getX();w=O*J;U=K.getY();r=U*T;kd=
w;ld=r;Ic=kd;Jc=ld;W=Math.round(z+w/E);V=Math.round(A+r/G);id=!1};this.up=function(a){ab=!1;if(Ca||Ua){O=K.getX();w=O*J;U=K.getY();r=U*T;if(Ua){jc=1;if(0<jc&&r<gf){if(w>ef){ba.pop();ba.pop();0==ba.length&&(jc=0);ga();return}if(w<ff){ga();a=window.open("","Mark Points");a.document.write("<div>Marked Points<br>");for(var b=[],d=0;d<ba.length;d+=2)W=z+ba[d]/E,V=A+ba[d+1]/G,Xa?ya=Xa.toLatLon(W,V):null!=Kc?(ya[0]=Kc+(Fe-Kc)*V/H,ya[1]=pd+(Ge-pd)*W/ka):(ya[0]=Math.round(W),ya[1]=Math.round(V)),a.document.write(ya[0].toFixed(4)+
","+ya[1].toFixed(4)+"<br>"),d||(b[0]=ya[0],b[1]=ya[1]);a.document.write(b[0].toFixed(4)+","+b[1].toFixed(4)+"<br>");return}}ba.push(w);ba.push(r);ga();return}if(3>xa)if(cb[xa]=w,Va[xa]=r,kc[xa]=Hd[y],xa){re=kc[1]-kc[0];cd=(cb[1]-cb[0])/re;Bc=(Va[1]-Va[0])/re;if(Pd&&null!=Ub){var d=cd*Ub,c=Bc*od,b=Math.round(60*Math.sqrt(d*d+c*c)),d=Math.atan2(d,-c)/.0174533;0>d&&(d+=360);oc=Le+yf[Math.round(d/22.5)]+" at "+b+" "+Me;nf=cb[0];of=0<Bc?Va[0]-15:Va[0]+30}b=parseInt(Ec,10);D=Math.round(Math.abs(4*(b+4)/
cd));lc=Math.round(Math.abs(2*(b+4)/Bc));lc<D&&(D=lc);120<D?D=120*Math.floor(D/120)+60:90<D?D=120:60<D?D=90:30<D?D=60:15<D?D=30:10<D?D=15:5<D?D=10:2<D?D=5:D||(D=1);lc=kc[1]/D*D+D;Ac=1;ve&&(Ac=-1);se=cd*D;Id=Bc*D;cc(x-1);xa=3;dd=2}else xa=1,cc(x-1),dd=1,oc=null;else if(r<qe&&w>oe&&3==xa){xf();ga();return}ga()}if(Tb)Tb=!1,ga();else if(null!=Da&&Ib&&(tb=!1,Da.innerHTML=Da.label_on),id)id=!1;else if(a.altKey)HAniS.resetZoom();else if(nb&&null!=X&&Ed)af(X,"z");else{O=K.getX();w=O*J;U=K.getY();r=U*T;if(0!=
Ra)for(b=0;b<Ra;b++)if(na[b].overlay>=k)aa(" Error...hotzone overlay # "+na[b].overlay+" > number of overlays = "+k);else if(C[na[b].overlay].checked&&(Y.clearRect(0,0,1,1),Y.drawImage(Q[y][na[b].overlay],Math.floor(W),Math.floor(V),1,1,0,0,1,1),u=Y.getImageData(0,0,1,1).data,Bd=(u[0]<<16)+(u[1]<<8)+u[2],Bd==na[b].color)){af(na[b],"z");return}if(0!=mb)for(var f,h,b=0;b<mb;b++)if(h=Sb[b],-1==h.overlay||C[h.overlay].checked)if(f=!1,h.isPan?h.isIcon?(d=(h.x0-z)*E-h.w2,c=(h.y0-A)*G-h.h2,w>d&&w<d+h.width&&
r>c&&r<c+h.height&&(f=!0)):(d=(h.x0-z)*E,c=(h.y0-A)*G,w>d&&w<d+h.width*E&&r>c&&r<c+h.height*G&&(f=!0)):w>h.x0&&w<h.x1&&r>h.y0&&r<h.y1&&(f=!0),f){af(Sb[b],"s");return}Ib&&(nb=!1,a.ctrlKey?(E-=.1*Fc,G-=.1*Fc):(E+=.1*Fc,G+=.1*Fc,E>Gc&&(E=Gc),G>Gc&&(G=Gc)),E<Kd||G<hd?(E=Kd,G=hd,W=w,V=r,A=z=0,ia=H,Aa=ka,ud=pc=0):(z=(W*E-w)/E,A=(V*G-r)/G,ia=Math.floor(H/G),A+ia>H-pc&&(A=H-pc-ia),Aa=Math.floor(ka/E),A=Math.round(A),z=Math.round(z),pc=Te,ud=Ue),Ze());fa();ga()}};this.toggleAutoRefresh=function(){Oc?(Ya.innerHTML=
Ya.label_off,null!=ac&&clearInterval(ac),Oc=!1):(Ya.innerHTML=Ya.label_on,ac=setInterval("HAniS.reloadFOF();",Sd),Oc=!0)};this.toggleLoopRock=function(){uc?(null!=La&&(La.innerHTML=La.label_on,La.className="looprock rock"),uc=!1):(null!=La&&(La.innerHTML=La.label_off,La.className="looprock loop"),uc=!0)};this.toggleExtrap=function(){Ca?(null!=Ba&&(Ba.innerHTML=Ba.label_on,L.style.cursor="default",null!=da&&(da.disabled=!1),ea(jb),xa=-1),Ca=!1,ga()):(null!=Ba&&(Ca=!0,oc=null,L.style.cursor="crosshair",
Ba.innerHTML=Ba.label_off,jb=ib,null!=da&&(da.disabled=!0),ib=!1,HAniS.resetZoom(),xf(),ga()),fa())};var xf=function(){dd=0;cb=Array(2);Va=Array(2);kc=Array(2);xa=0;oc=null;cc(0)},ea=function(a){ib=!a;HAniS.toggleIsLooping()};this.doEnhance=function(a){if(fc||Qb){var b=va[0].height,d=va[0].width;a=parseInt(ua.value,10);var c,f,h,k;0<=a&&(c=Na[a],f=Oa[a],h=Pa[a],k=rd[a],Mc[Bb]=a);for(var d=b*d*4,g=0;g<lb.length;g++)if(va[g].gotit){va[g].gotit=!1;var m=Uc[g].data,n=zd[g];if(0>a)for(var p=0;p<d;p+=4)m[p]=
n[p],m[p+1]=n[p+1],m[p+2]=n[p+2],m[p+3]=n[p+3];else for(p=0;p<d;p+=4)b=n[p],b===n[p+1]&&b===n[p+2]&&(m[p]=c[b],m[p+1]=f[b],m[p+2]=h[b],m[p+3]=k[b]);Rb[g].putImageData(Uc[g],0,0);va[g].gotit=!0}}};this.overClick=function(a){var b;if(a.target.checked)for(b=0;b<C.length;b++)a.target!=C[b]&&0!=a.target.name&&a.target.name==C[b].name&&(C[b].checked=!1);hc=!0;for(b=0;b<hb.length;b++)a.target!=C[b]&&Ye(b),Db&&!Db[b]&&C[b].checked&&(hc=!1),null!=ua&&b==Bb&&(ua.disabled=!C[b].checked);fa()};this.toggleIsLooping=
function(){ib?(ib=!1,null!=da&&(da.className="startstop start",da.innerHTML=da.label_on)):(ib=!0,null!=da&&(da.className="startstop stop",da.innerHTML=da.label_off))};this.toggleZooming=function(){Ib?(HAniS.resetZoom(),oa.className="zoom off"):(oa.innerHTML=oa.label_off,oa.className="zoom on",Ib=!0,null!=Da&&(tb=!1,Da.innerHTML=Da.label_on),nb=!1,Ca&&HAniS.toggleExtrap())};var rc=function(a,b){xc[a]=b;Ld&&1==b&&(Wa.value=a+1,Hc.innerHTML=jd.replace("*",a+1));if(Yc){var d=ee+a*(gc+Wc),c=ie;0==b?c=
he:-1==b&&(c=ge);le.fillStyle=c;le.fillRect(d,Vc/2,gc,Vc)}};this.togclick=function(a){var b=fe.getX();fe.getY();var d=ee;for(a=0;a<xc.length;a++){if(b>d&&b<d+gc){b=0;0<=xc[a]&&(b=-1);rc(a,b);break}d=d+gc+Wc}};var Cf=function(a){Yc&&($c.width=B,ee=B/2-a*(gc+Wc)/2);for(var b=0;b<a;b++)null!=Zc&&"n"==Zc[b].toLowerCase().trim()?rc(b,-1):rc(b,0)},cc=function(a){rc(y,0);y=a;rc(y,1);null!=Sa&&null!=Ia&&null!=Ia[y]&&(Sa.innerHTML=Ia[y])},qc=function(a){rc(y,0);do 0<a?(y+=1,y>=x&&(uc?(y=x-1,Ob=-Ob):y=0)):
(--y,0>y&&(uc?(y=0,Ob=-Ob):y=x-1)),a=Ob;while(0>xc[y]);rc(y,1);null!=Sa&&null!=Ia&&null!=Ia[y]&&(Sa.innerHTML=Ia[y])},yb=function(a,b,d,c,k){f.globalAlpha=1;f.font=a.font;var h=a.fontHeight;d=d-h-6;var m=f.measureText(c).width;1==k&&(b-=m);0==k&&(b-=m/2);5>b&&(b=5);5>d&&(d=5);d+h+3>F&&(d=F-h-6);b+3+m>B&&(b=B-m-6);f.save();f.beginPath();f.fillStyle=a.bg;null!=a.scolor&&(f.shadowColor=a.scolor,f.shadowBlur=a.sblur,f.shadowOffsetX=a.sxoff,f.shadowOffsetY=a.syoff);nd=b-3;jf=d;ye=m+6;Md=h+6;f.fillRect(nd,
jf,ye,Md);f.closePath();f.restore();f.textBaseline="bottom";f.fillStyle=a.fg;f.fillText(c,b,d+h+3)},ga=function(){f.clearRect(0,0,B,F);Ed=!1;if(Ca){f.beginPath();f.lineWidth=2;f.strokeStyle="white";var a=xa;1<a&&(a=2);for(var b=0;b<a;b++)1<xa&&(f.moveTo(cb[0],Va[0]),f.lineTo(cb[1],Va[1])),f.moveTo(cb[b]-15,Va[b]),f.lineTo(cb[b]+15,Va[b]),f.moveTo(cb[b],Va[b]-15),f.lineTo(cb[b],Va[b]+15);f.closePath();f.stroke();if(3==xa){var d=O,c=U;f.moveTo(d,c);f.fillStyle=Hb;f.fillRect(d-2,c-2,5,5);for(var b=lc,
a=Math.round(d+Ac*cd*(lc-kc[1])),m=Math.round(c+Ac*Bc*(lc-kc[1])),h=0;300>h;h++){f.beginPath();f.lineWidth=1;f.strokeStyle=Hb;f.moveTo(d,c);f.lineTo(a,m);f.stroke();f.beginPath();f.lineWidth=3;f.rect(a-2,m-2,5,5);f.stroke();if(3>a||a+3>B||3>m||m+3>F)break;c=sb+b;c=100*Math.floor(c/60)+c%60;c%=2400;ue?(d="AM",1200<=c?(1300<=c&&(c-=1200),d="PM"):100>c&&(c+=1200),d=Math.floor(c/100)+":"+Math.floor(Math.floor(c%100)/10)+Math.floor(c%10)+" "+d):(d=c+" ",1E3>c&&(d="0"+c),100>c&&(d="00"+c),10>c&&(d="000"+
c));c=0;Math.abs(Id)<mc+5&&(c=45*.0174533);var n=m;0>se*Id&&!c&&(n=m+mc);f.font=Ec;var d=d+" "+te,g=f.measureText(d).width;f.fillStyle=Dc;c?(f.save(),f.translate(a+5,m),f.rotate(c),f.fillRect(2,-2,g+4,mc+3),f.fillStyle=Hb,f.textBaseline="bottom",f.fillText(d,5,mc),f.restore()):(f.fillRect(a+2,n-mc-2+c,g+4,mc+3),f.fillStyle=Hb,f.textBaseline="bottom",f.fillText(d,a+5,n));d=a;c=m;a=Math.round(d+Ac*se);m=Math.round(c+Ac*Id);b+=D}}null!=oc&&yb(Pd,nf,of,oc,0);yb(hf,999,10,pe[dd],0);oe=nd;qe=Md}if(Ua){jc?
(yb(df,10,10,bd[1],0),ff=nd+ye,yb(ne,999,10,bd[2],0)):yb(ne,999,10,bd[0],0);ef=nd;gf=Md;f.beginPath();f.lineWidth=2;f.strokeStyle=me;for(b=0;b<ba.length;b+=2)b?f.lineTo(ba[b],ba[b+1]):f.moveTo(ba[b],ba[b+1]);4<ba.length&&f.lineTo(ba[0],ba[1]);f.stroke();for(b=0;b<ba.length;b+=2)f.beginPath(),f.rect(ba[b]-2,ba[b+1]-2,5,5),f.stroke()}Tb&&(b=Ub*(kd-Ic)/E,a=od*(ld-Jc)/G,b=" "+Math.sqrt(b*b+a*a).toFixed(xe)+" "+Ae+" ",yb(kf,Ic/J,Jc/T,b,-1),f.beginPath(),f.strokeStyle=ze,f.lineWidth=3,f.moveTo(kd/J,ld/
T),f.lineTo(Ic/J,Jc/T),f.stroke(),f.closePath());ab&&yb(Be,be,ce,ae,-1);if(Xb||Vb)if(O=K.getX(),w=O*J,U=K.getY(),r=U*T,0<=w&&0<=r){W=z+w/E;V=A+r/G;if(Vb){Xa?ya=Xa.toLatLon(W,V):(ya[0]=Kc+(Fe-Kc)*V/H,ya[1]=pd+(Ge-pd)*W/ka);lf=Ce+ya[0].toFixed(Nd)+"  "+De+ya[1].toFixed(Nd);b=U;if(Tb||ab)b=U+Ee.fontHeight+6;yb(Ee,O+10,b,lf,-1)}if(Xb)for(W=Math.round(W),V=Math.round(V),a=0;a<k;a++)if(Q[y][a].gotit&&C[a].checked&&(a==Bb||null!=Mc[a]&&0<=Mc[a])){Y.clearRect(0,0,1,1);a==Bb?Y.drawImage(lb[y],W,V,1,1,0,0,
1,1):Y.drawImage(Q[y][a],W,V,1,1,0,0,1,1);u=Y.getImageData(0,0,1,1).data;qd=999;v=Mc[a];m=Ke;if(0==u[3])m=Re[v];else{if(a==Bb)Ne=0,Kb=u[0],qd=0;else for(b=0;b<Ma[v].length-1;b++)xb[0]=u[0]-Na[v][b],0>xb[0]*(Na[v][b+1]-u[0]-1)||(xb[1]=u[1]-Oa[v][b],0>xb[1]*(Oa[v][b+1]-u[1]-1)||(xb[2]=u[2]-Pa[v][b],0>xb[2]*(Pa[v][b+1]-u[2]-1)||(nc=Rd[v][b],Qd=xb[nc]/$b[v][b][nc],Qe=Math.abs(xb[Oe[nc]]-Qd*$b[v][b][Oe[nc]])+Math.abs(xb[Pe[nc]]-Qd*$b[v][b][Pe[nc]]),Qe<qd&&(Kb=b,qd=Qe,Ne=Qd))));if(999>qd)m=Zb[v][Kb],-1!=
wb[v][Kb]&&(m=m+" "+(Ma[v][Kb]+Ne*(Ma[v][Kb+1]-Ma[v][Kb])).toFixed(wb[v][Kb])+" "+Yb[v][Kb]);else if(1<Nc){for(b=0;b<Ma[v].length-1;b++)if(Math.abs(u[0]-Na[v][b])<Nc&&Math.abs(u[1]-Oa[v][b])<Nc&&Math.abs(u[2]-Pa[v][b])<Nc){m=Zb[v][b];-1!=wb[v][b]&&(m=m+" "+Ma[v][b].toFixed(wb[v][b])+" "+Yb[v][b]);break}aa("RGB err: R="+u[0]+" G="+u[1]+" B="+u[2])}}yb(mf,O-10,U,m,1)}}!nb||Ca||tb||Xb||null==X||(f.drawImage(X.can,0,0,X.width,X.height,X.xmin/J,X.ymin/T,X.width/J,X.height/T),yb(Be,(X.xmin+X.xmax)/2/J,
(X.ymin+X.ymax)/2/T,X.tip,0),Ed=!0)},fa=function(){var a;if(Fd)try{n.clearRect(0,0,B,F);n.globalAlpha=1;if(zc&&ob&&0<=ja&&ob[ja].gotit)n.drawImage(ob[ja],z*Ha[ja],A*Ha[ja],Aa*Ha[ja],ia*Ha[ja],0,0,B,F);else if(za[y].gotit&&n.drawImage(za[y],z,A,Aa,ia,0,0,B,F),pa&&(n.globalAlpha=1,za[y].gotit))for(var b=0;b<pa.length;b+=4)n.drawImage(za[y],pa[b],pa[b+1],pa[b+2],pa[b+3],pa[b],pa[b+1],pa[b+2],pa[b+3]);if(0<k){for(b=0;b<k;b++)a=Nb?Nb[b]:b,C[a].checked&&(zc&&pb&&0<=ja&&pb[ja].gotit&&ke==a?n.drawImage(pb[ja],
z*Ha[ja],A*Ha[ja],Aa*Ha[ja],ia*Ha[ja],0,0,B,F):Q[y][a].gotit&&(Sc&&(n.globalAlpha=Sc[a]),Wb&&1!==Wb[a]?0===Wb[a]&&n.drawImage(Q[y][a],0,0,ka,H,0,0,B,F):n.drawImage(Q[y][a],z,A,Aa,ia,0,0,B,F)));if(vb)for(n.globalAlpha=1,b=0;b<k;b++)a=Nb?Nb[b]:b,Q[y][a].gotit&&C[a].checked&&vb[a]&&n.drawImage(Q[y][a],S[a][0],S[a][1],S[a][2],S[a][3],S[a][0],S[a][1],S[a][2],S[a][3]);Xb&&ga()}Se&&vd();if(Zd){n.globalAlpha=1;var c;for(a=0;a<mb;a++)c=Sb[a],null!=c.icon&&(-1==c.overlay||-1!=c.overlay&&C[c.overlay].checked)&&
c.icon.gotit&&(c.isPan?n.drawImage(c.icon,0,0,c.width,c.height,((c.x0-z)*E-c.w2)/J,((c.y0-A)*G-c.h2)/T,c.width/J,c.height/T):n.drawImage(c.icon,0,0,c.width,c.height,c.x0/J,c.y0/T,c.width/J,c.height/J))}}catch(e){aa("Error:"+e)}},vd=function(){if(Td&&bc>Za){n.save();n.fillStyle="blue";n.strokeStyle="white";n.lineWidth=3;n.strokeRect(sd,td,200,14);n.fillRect(sd,td,Za/bc*200,14);var a=n.measureText("Loading images").width;n.fillStyle="orange";n.font="14px arial";n.fillText("Loading images",sd+100-a/
2,td+11);n.restore()}else Se=!1,Lb&&(Ea.style.visibility="hidden")},aa=function(a){if($a&&Ab&&!Ab.closed)try{Ab.document.write(a+"<br>")}catch(b){}},wf=function(){ib&&qc(Ob);cf=y==x-1?de+Ga:Ga;fa();setTimeout(function(){zf(wf)},cf)},Qc=function(a){for(;-180>a;)a+=360;for(;180<a;)a-=360;return a}};
